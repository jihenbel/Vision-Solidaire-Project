{% extends 'base.html.twig' %}

{% block body %}
    <html>
    <body >Liste Des messages </body>
    //on doit definir le bloc avec le div id=user_details
    <div id="user_details">

    </div>

    </html>
{% endblock %}

    {% block javascripts %}
        <script
                src="https://code.jquery.com/jquery-3.3.1.js"
                integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
                crossorigin="anonymous"></script>
        <script>
            $(document).ready(function(){
                fetch_user();
                setInterval(function () {
                    update_last_activity();
                    fetch_user();
                },5000);
                function fetch_user()
                {
                    $.ajax({
                        url:"{{ path('fetch_user') }}",
                        method:"POST",
                        success:function(data){
                            $('#user_details').html(data);
                        }
                    })
                }

                function  update_last_activity() {
                    $.ajax({
                        url:"{{ path('update_last_activity') }}",
                        success:function(){

                        }
                    })

                }
            })
        </script>

    {% endblock %}

